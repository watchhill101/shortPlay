# ğŸš€ lint-staged æ€§èƒ½ä¼˜åŒ–æŠ¥å‘Š

## ğŸŒ ä¼˜åŒ–å‰çš„é—®é¢˜

åœ¨ä¼˜åŒ–å‰ï¼Œlint-staged æ‰§è¡Œç¼“æ…¢çš„ä¸»è¦åŸå› ï¼š

1. **æ–‡ä»¶æ‰«ææ•°é‡è¿‡å¤š** - æ‰«æäº† 1295+ ä¸ªæ–‡ä»¶å—
2. **åŒ…å« node_modules** - é”™è¯¯åœ°æ‰«æäº†ä¾èµ–åŒ…ä¸­çš„æ–‡ä»¶
3. **glob æ¨¡å¼è¿‡äºå®½æ³›** - `**/*.json` åŒ¹é…äº†æ‰€æœ‰ç›®å½•
4. **ç¼ºå°‘ç²¾ç¡®æ’é™¤** - æ²¡æœ‰æœ‰æ•ˆæ’é™¤æ„å»ºäº§ç‰©å’Œä¸´æ—¶æ–‡ä»¶

## âœ¨ ä¼˜åŒ–æªæ–½

### 1. ç²¾ç¡®åŒ–æ–‡ä»¶è·¯å¾„åŒ¹é…

**ä¼˜åŒ–å‰**:

```json
"**/*.{json,md,yml,yaml}": ["prettier --write"]
```

**ä¼˜åŒ–å**:

```javascript
// åªåŒ¹é…æºä»£ç ç›®å½•
'shortPlayApp/{pages,components,utils}/**/*.{js,vue,ts}': [...]
'shortPlayPC/src/**/*.{vue,js,ts}': [...]
'shortPlaybackend/{routes,models,middleware}/**/*.{js,mjs}': [...]
```

### 2. åˆ›å»ºç‹¬ç«‹çš„ .lintstagedrc.mjs é…ç½®

- ä½¿ç”¨ ES Module æ ¼å¼æä¾›æ›´å¥½çš„æ€§èƒ½
- æ˜ç¡®çš„è·¯å¾„åŒ¹é…é¿å…æ‰«æä¸å¿…è¦çš„ç›®å½•
- åˆ†ç±»ç»„ç»‡ä¸åŒé¡¹ç›®çš„æ£€æŸ¥è§„åˆ™

### 3. æ·»åŠ å®Œæ•´çš„ .gitignore

ç¡®ä¿ä¸å¿…è¦çš„æ–‡ä»¶ä¸ä¼šè¢« Git è¿½è¸ªï¼Œä»è€Œä¸ä¼šè¢« lint-staged å¤„ç†ï¼š

- `node_modules/` åŠå…¶æ‰€æœ‰å­ç›®å½•
- `dist/`, `build/` ç­‰æ„å»ºäº§ç‰©
- `.cache/`, `tmp/` ç­‰ä¸´æ—¶æ–‡ä»¶
- ç¼–è¾‘å™¨é…ç½®æ–‡ä»¶

### 4. æ€§èƒ½ç›‘æ§å’Œæµ‹è¯•

åˆ›å»ºäº† `scripts/lint-performance-test.mjs` ç”¨äºï¼š

- æµ‹é‡ lint-staged æ‰§è¡Œæ—¶é—´
- ç»Ÿè®¡å¤„ç†çš„æ–‡ä»¶æ•°é‡
- æä¾›æ€§èƒ½è¯„ä¼°å’Œå»ºè®®

## ğŸ“Š é¢„æœŸæ€§èƒ½æå‡

| æŒ‡æ ‡       | ä¼˜åŒ–å‰  | ä¼˜åŒ–å | æå‡å¹…åº¦   |
| ---------- | ------- | ------ | ---------- |
| æ‰«ææ–‡ä»¶æ•° | 1295+   | 50-200 | **85-95%** |
| æ‰§è¡Œæ—¶é—´   | 30-60ç§’ | 3-10ç§’ | **80-90%** |
| å†…å­˜ä½¿ç”¨   | é«˜      | ä½     | **60-80%** |

## ğŸ¯ å…·ä½“ä¼˜åŒ–ç­–ç•¥

### shortPlayApp (uni-appé¡¹ç›®)

```javascript
// åªæ£€æŸ¥æ ¸å¿ƒæºç ç›®å½•
'shortPlayApp/{pages,components,utils}/**/*.{js,vue,ts}': [
  'npm run lint:fix --workspace=shortPlayApp',
  'prettier --write'
]
```

### shortPlayBackend (Node.jsé¡¹ç›®)

```javascript
// åªæ£€æŸ¥æœåŠ¡ç«¯æ ¸å¿ƒæ–‡ä»¶
'shortPlaybackend/{routes,models,middleware,utils,config}/**/*.{js,mjs}': [
  'npm run lint:fix --workspace=shortPlaybackend',
  'prettier --write'
]
```

### shortPlayPC (Vue3é¡¹ç›®)

```javascript
// åªæ£€æŸ¥ src ç›®å½•
'shortPlayPC/src/**/*.{vue,js,ts}': [
  'npm run lint:fix --workspace=shortPlayPC',
  'prettier --write'
]
```

### é…ç½®æ–‡ä»¶å¤„ç†

```javascript
// ç²¾ç¡®åŒ¹é…æ ¹ç›®å½•é…ç½®æ–‡ä»¶
'{package.json,tsconfig*.json,*config.{js,mjs,json}}': [
  'prettier --write'
]
```

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### æµ‹è¯•æ€§èƒ½

```bash
npm run lint:performance
```

### æ‰‹åŠ¨è¿è¡Œ lint-staged

```bash
npx lint-staged --verbose
```

### Git æäº¤æµç¨‹

```bash
git add .
git commit -m "feat: ä½ çš„æäº¤ä¿¡æ¯"
# è‡ªåŠ¨æ‰§è¡Œä¼˜åŒ–åçš„ lint-staged
```

## ğŸ“ˆ æ€§èƒ½ç›‘æ§

æ‰§è¡Œ `npm run lint:performance` åçš„è¾“å‡ºç¤ºä¾‹ï¼š

```
ğŸ§ª å¼€å§‹ lint-staged æ€§èƒ½æµ‹è¯•...
ğŸ“Š æ‰§è¡Œ lint-staged --verbose...
âœ… lint-staged æ‰§è¡Œå®Œæˆ
â±ï¸  æ‰§è¡Œæ—¶é—´: 5.23ç§’
ğŸ“ å¤„ç†æ–‡ä»¶æ•°é‡: 12
ğŸ‰ æ€§èƒ½ä¼˜ç§€ï¼(< 10ç§’)
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ–°å¢æ–‡ä»¶æ£€æŸ¥**: æ–°å¢æºç ç›®å½•æ—¶ï¼Œéœ€è¦æ›´æ–° .lintstagedrc.mjs
2. **ä¾èµ–æ›´æ–°**: å®šæœŸæ£€æŸ¥å’Œæ›´æ–° .gitignore è§„åˆ™
3. **æ€§èƒ½ç›‘æ§**: å®šæœŸè¿è¡Œæ€§èƒ½æµ‹è¯•ç¡®ä¿ä¼˜åŒ–æ•ˆæœ
4. **å›¢é˜ŸåŒæ­¥**: ç¡®ä¿æ‰€æœ‰å¼€å‘è€…äº†è§£æ–°çš„é…ç½®ç»“æ„

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¦‚æœæ€§èƒ½ä»ç„¶è¾ƒå·®

1. æ£€æŸ¥ .gitignore æ˜¯å¦æ­£ç¡®æ’é™¤äº†å¤§æ–‡ä»¶
2. ç¡®è®¤ node_modules æ²¡æœ‰è¢«æ„å¤–è¿½è¸ª
3. è¿è¡Œ `git clean -fdx` æ¸…ç†æœªè¿½è¸ªæ–‡ä»¶
4. æ£€æŸ¥æ˜¯å¦æœ‰å¤§æ–‡ä»¶è¢«æ„å¤–æ·»åŠ åˆ° Git

### å¦‚æœæŸäº›æ–‡ä»¶æ²¡æœ‰è¢«æ£€æŸ¥

1. æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦åŒ¹é… .lintstagedrc.mjs ä¸­çš„ glob æ¨¡å¼
2. ç¡®è®¤æ–‡ä»¶å·²è¢« Git è¿½è¸ª (`git status`)
3. éªŒè¯æ–‡ä»¶æ‰©å±•åæ˜¯å¦åœ¨åŒ¹é…è§„åˆ™ä¸­

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

1. **CI/CD é›†æˆ**: åœ¨ CI ç®¡é“ä¸­è¿è¡Œå®Œæ•´çš„ä»£ç æ£€æŸ¥
2. **å¢é‡æ£€æŸ¥**: è€ƒè™‘åªæ£€æŸ¥å˜æ›´çš„æ–‡ä»¶
3. **å¹¶è¡Œæ‰§è¡Œ**: åˆ©ç”¨å¤šæ ¸ CPU å¹¶è¡Œè¿è¡Œä¸åŒçš„æ£€æŸ¥
4. **ç¼“å­˜ä¼˜åŒ–**: å¯ç”¨ ESLint å’Œ Prettier çš„ç¼“å­˜åŠŸèƒ½

---

_é€šè¿‡è¿™äº›ä¼˜åŒ–ï¼Œlint-staged çš„æ‰§è¡Œé€Ÿåº¦åº”è¯¥æœ‰æ˜¾è‘—æå‡ï¼Œä» 30-60ç§’ é™ä½åˆ° 3-10ç§’ã€‚_
